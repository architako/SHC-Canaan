<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø¨ÙŠØ§Ù†Ø§ØªÙƒ - Ù…Ø®ÙŠÙ… Ø§Ù„Ù‡Ù„Ø§Ù„ Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠ</title>
  <style>
    body {
      font-family: Tahoma, Arial;
      background:#222;
      color:#fff;
      text-align:center;
    }
    .box {
      width:900px;
      margin:30px auto;
      background:#333;
      padding:20px;
      border-radius:12px;
      border:2px solid #f1c40f;
      text-align:right;
    }
    h3 { 
      color:#f1c40f; 
      text-align:center; 
      margin-top:0;
    }
    .info {
      font-size:14px;
      margin-bottom:10px;
      color:#ddd;
      text-align:center;
    }

    /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¥Ø·Ø§Ø± + Ø§Ù„Ù„ÙˆØ¯Ø± */
    .frame-wrapper {
      position: relative;
      width:100%;
      height:600px;
      margin-top:10px;
      border-radius:8px;
      overflow:hidden;
      background:#111;
    }

    iframe {
      width:100%;
      height:100%;
      border:none;
      display:none; /* Ù†Ø®ÙÙŠÙ‡ Ù„Ø­Ø¯ Ù…Ø§ ÙŠÙƒØªÙ…Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
    }

    /* Ø·Ø¨Ù‚Ø© Ø§Ù„Ù„ÙˆØ¯Ø± ÙÙˆÙ‚ Ø§Ù„Ø¥Ø·Ø§Ø± */
    .loader-overlay {
      position:absolute;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      background:rgba(0,0,0,0.4);
    }

    .loader-text {
      margin-top:10px;
      color:#f1c40f;
      font-size:14px;
      text-align:center;
    }

    /* Ø¯Ø§Ø¦Ø±Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
    .spinner {
      width:40px;
      height:40px;
      border-radius:50%;
      border:4px solid #f1c40f;
      border-top-color:transparent;
      animation:spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform:rotate(360deg); }
    }

    .actions {
      margin-top:12px;
      text-align:center;
    }
    .btn {
      display:inline-block;
      padding:8px 16px;
      margin:4px;
      border-radius:8px;
      border:none;
      cursor:pointer;
      font-weight:bold;
      text-decoration:none;
      font-size:14px;
    }
    .btn-back  { background:#f1c40f; color:#222; }
    .btn-link  { background:#555;   color:#fff; }
    .error {
      color:#ff7675;
      text-align:center;
      margin:20px 0;
    }
  </style>
</head>
<body>

  <div class="box">
    <h3>Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø§Ù„Ù…Ø³Ø¬Ù‘Ù„Ø© - Ù…Ø®ÙŠÙ… Ø§Ù„Ù‡Ù„Ø§Ù„ Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠ</h3>

    <div class="info" id="info"></div>
    <div id="error" class="error"></div>

    <!-- Ù‡Ù†Ø§ Ø§Ù„Ø¨ÙˆÙƒØ³ Ø§Ù„Ø°ÙŠ ÙŠØ­ØªÙˆÙŠ iframe + Ù„ÙˆØ¯Ø± ÙÙˆÙ‚Ù‡ -->
    <div class="frame-wrapper">
      <div id="loader" class="loader-overlay">
        <div>
          <div class="spinner"></div>
          <div class="loader-text">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±...</div>
        </div>
      </div>

      <iframe id="dataFrame"></iframe>
    </div>

    <div class="actions">
      <a href="index.html" class="btn btn-back">â¬… Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</a>
      <a href="https://chat.whatsapp.com/XXXXX" target="_blank" class="btn btn-link">Ù‚Ø±ÙˆØ¨ Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨</a>
      <a href="https://facebook.com/XXXXX" target="_blank" class="btn btn-link">ØµÙØ­Ø© Ø§Ù„ÙÙŠØ³ Ø¨ÙˆÙƒ</a>
    </div>
  </div>

  <script>
    // ğŸ”— Ø¶Ø¹ Ù‡Ù†Ø§ Ø±Ø§Ø¨Ø· Ø§Ù„ÙˆÙŠØ¨ Ø¢Ø¨ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ Ù…Ù† Apps Script
    const INNER_WEBAPP_URL = 'https://script.google.com/macros/s/AKfycbzJ_P5IcL2-jlBq5Y_v8cgO_1pyF_bflQJHrFTG8sC0ofCFZvHmpLz5ShZ9YxdveTuG/exec';

    const params = new URLSearchParams(window.location.search);
    const nid   = params.get('national_id') || '';
    const phone = params.get('phone') || '';

    const infoEl   = document.getElementById('info');
    const errorEl  = document.getElementById('error');
    const frame    = document.getElementById('dataFrame');
    const loader   = document.getElementById('loader');

    if (!nid || !phone) {
      errorEl.textContent = 'ØªÙ… ÙØªØ­ Ø§Ù„ØµÙØ­Ø© Ø¨Ø¯ÙˆÙ† Ø¨ÙŠØ§Ù†Ø§Øª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„. Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø¹ÙˆØ¯Ø© ÙˆØ¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.';
      if (loader) loader.style.display = 'none';
    } else {
      infoEl.innerHTML = 
        'ØªÙ… Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©: <strong>' + nid +
        '</strong> Ùˆ Ø¢Ø®Ø± 4 Ø£Ø±Ù‚Ø§Ù… Ù…Ù† Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„: <strong>' + phone + '</strong>.';

      const url = INNER_WEBAPP_URL +
        '?national_id=' + encodeURIComponent(nid) +
        '&phone='       + encodeURIComponent(phone);

      // Ù†Ø¨Ø¯Ø£ ØªØ­Ù…ÙŠÙ„ ØµÙØ­Ø© Apps Script Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¥Ø·Ø§Ø±
      frame.src = url;

      // Ø¹Ù†Ø¯Ù…Ø§ ÙŠÙƒØªÙ…Ù„ ØªØ­Ù…ÙŠÙ„ iframe Ù†Ø®ÙÙŠ Ø§Ù„Ù„ÙˆØ¯Ø± ÙˆÙ†Ø¸Ù‡Ø± Ø§Ù„Ø¥Ø·Ø§Ø±
      frame.onload = function() {
        if (loader) loader.style.display = 'none';
        frame.style.display = 'block';
      };
    }
  </script>

</body>
</html>
